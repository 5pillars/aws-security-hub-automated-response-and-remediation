{
  "Description": "(SO0111P) AWS Security Hub Automated Response & Remediation AFSBP 1.0.0 Compliance Pack - Admin Account, v1.4.0",
  "AWSTemplateFormatVersion": "2010-09-09",
  "Parameters": {
    "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter": {
      "Type": "AWS::SSM::Parameter::Value<String>",
      "Default": "/Solutions/SO0111/OrchestratorArn"
    },
    "AFSBPAutoScaling1AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP AutoScaling.1"
    },
    "AFSBPCloudTrail1AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP CloudTrail.1"
    },
    "AFSBPCloudTrail2AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP CloudTrail.2"
    },
    "AFSBPConfig1AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP Config.1"
    },
    "AFSBPEC21AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP EC2.1"
    },
    "AFSBPEC22AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP EC2.2"
    },
    "AFSBPEC26AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP EC2.6"
    },
    "AFSBPEC27AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP EC2.7"
    },
    "AFSBPIAM7AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP IAM.7"
    },
    "AFSBPIAM8AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP IAM.8"
    },
    "AFSBPLambda1AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP Lambda.1"
    },
    "AFSBPRDS1AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP RDS.1"
    },
    "AFSBPRDS6AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP RDS.6"
    },
    "AFSBPRDS7AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP RDS.7"
    },
    "AFSBPS31AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP S3.1"
    },
    "AFSBPS32AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP S3.2"
    },
    "AFSBPS33AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP S3.3"
    },
    "AFSBPS35AutoTrigger": {
      "Type": "String",
      "Default": "DISABLED",
      "AllowedValues": [
        "ENABLED",
        "DISABLED"
      ],
      "Description": "This will fully enable automated remediation for AFSBP S3.5"
    }
  },
  "Resources": {
    "StandardShortName7DDF6BE6": {
      "Type": "AWS::SSM::Parameter",
      "Properties": {
        "Type": "String",
        "Value": "AFSBP",
        "Description": "Provides a short (1-12) character abbreviation for the standard.",
        "Name": "/Solutions/SO0111/aws-foundational-security-best-practices/shortname"
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/StandardShortName/Resource"
      }
    },
    "StandardVersionCB2C6951": {
      "Type": "AWS::SSM::Parameter",
      "Properties": {
        "Type": "String",
        "Value": "enabled",
        "Description": "This parameter controls whether the SHARR step function will process findings for this version of the standard.",
        "Name": "/Solutions/SO0111/aws-foundational-security-best-practices/1.0.0/status"
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/StandardVersion/Resource"
      }
    },
    "AFSBPAutoScaling1EventsRuleRole40C42B87": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP AutoScaling.1/EventsRuleRole/Resource"
      }
    },
    "AFSBPAutoScaling1EventsRuleRoleDefaultPolicy8681AE72": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPAutoScaling1EventsRuleRoleDefaultPolicy8681AE72",
        "Roles": [
          {
            "Ref": "AFSBPAutoScaling1EventsRuleRole40C42B87"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP AutoScaling.1/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPAutoScaling1AutoEventRule0BE9087E": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP AutoScaling.1 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/AutoScaling.1"
              ],
              "ProductFields": {
                "ControlId": [
                  "AutoScaling.1"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_AutoScaling.1_AutoTrigger",
        "State": {
          "Ref": "AFSBPAutoScaling1AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPAutoScaling1EventsRuleRole40C42B87",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP AutoScaling.1/AutoEventRule/Resource"
      }
    },
    "AFSBPCloudTrail1EventsRuleRole71D06D7A": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP CloudTrail.1/EventsRuleRole/Resource"
      }
    },
    "AFSBPCloudTrail1EventsRuleRoleDefaultPolicy685CCD45": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPCloudTrail1EventsRuleRoleDefaultPolicy685CCD45",
        "Roles": [
          {
            "Ref": "AFSBPCloudTrail1EventsRuleRole71D06D7A"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP CloudTrail.1/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPCloudTrail1AutoEventRule468DC6B9": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP CloudTrail.1 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/CloudTrail.1"
              ],
              "ProductFields": {
                "ControlId": [
                  "CloudTrail.1"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_CloudTrail.1_AutoTrigger",
        "State": {
          "Ref": "AFSBPCloudTrail1AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPCloudTrail1EventsRuleRole71D06D7A",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP CloudTrail.1/AutoEventRule/Resource"
      }
    },
    "AFSBPCloudTrail2EventsRuleRole94823032": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP CloudTrail.2/EventsRuleRole/Resource"
      }
    },
    "AFSBPCloudTrail2EventsRuleRoleDefaultPolicyF9708F0D": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPCloudTrail2EventsRuleRoleDefaultPolicyF9708F0D",
        "Roles": [
          {
            "Ref": "AFSBPCloudTrail2EventsRuleRole94823032"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP CloudTrail.2/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPCloudTrail2AutoEventRule1FF1B100": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP CloudTrail.2 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/CloudTrail.2"
              ],
              "ProductFields": {
                "ControlId": [
                  "CloudTrail.2"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_CloudTrail.2_AutoTrigger",
        "State": {
          "Ref": "AFSBPCloudTrail2AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPCloudTrail2EventsRuleRole94823032",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP CloudTrail.2/AutoEventRule/Resource"
      }
    },
    "AFSBPConfig1EventsRuleRole837C8327": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP Config.1/EventsRuleRole/Resource"
      }
    },
    "AFSBPConfig1EventsRuleRoleDefaultPolicy7196564A": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPConfig1EventsRuleRoleDefaultPolicy7196564A",
        "Roles": [
          {
            "Ref": "AFSBPConfig1EventsRuleRole837C8327"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP Config.1/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPConfig1AutoEventRule0D737DBE": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP Config.1 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/Config.1"
              ],
              "ProductFields": {
                "ControlId": [
                  "Config.1"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_Config.1_AutoTrigger",
        "State": {
          "Ref": "AFSBPConfig1AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPConfig1EventsRuleRole837C8327",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP Config.1/AutoEventRule/Resource"
      }
    },
    "AFSBPEC21EventsRuleRole43C39877": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.1/EventsRuleRole/Resource"
      }
    },
    "AFSBPEC21EventsRuleRoleDefaultPolicy9E00CFC6": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPEC21EventsRuleRoleDefaultPolicy9E00CFC6",
        "Roles": [
          {
            "Ref": "AFSBPEC21EventsRuleRole43C39877"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.1/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPEC21AutoEventRule25775F17": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP EC2.1 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/EC2.1"
              ],
              "ProductFields": {
                "ControlId": [
                  "EC2.1"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_EC2.1_AutoTrigger",
        "State": {
          "Ref": "AFSBPEC21AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPEC21EventsRuleRole43C39877",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.1/AutoEventRule/Resource"
      }
    },
    "AFSBPEC22EventsRuleRoleDE163F68": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.2/EventsRuleRole/Resource"
      }
    },
    "AFSBPEC22EventsRuleRoleDefaultPolicy17C27BDE": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPEC22EventsRuleRoleDefaultPolicy17C27BDE",
        "Roles": [
          {
            "Ref": "AFSBPEC22EventsRuleRoleDE163F68"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.2/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPEC22AutoEventRule58F6227A": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP EC2.2 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/EC2.2"
              ],
              "ProductFields": {
                "ControlId": [
                  "EC2.2"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_EC2.2_AutoTrigger",
        "State": {
          "Ref": "AFSBPEC22AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPEC22EventsRuleRoleDE163F68",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.2/AutoEventRule/Resource"
      }
    },
    "AFSBPEC26EventsRuleRole1B433881": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.6/EventsRuleRole/Resource"
      }
    },
    "AFSBPEC26EventsRuleRoleDefaultPolicy1F92B9E6": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPEC26EventsRuleRoleDefaultPolicy1F92B9E6",
        "Roles": [
          {
            "Ref": "AFSBPEC26EventsRuleRole1B433881"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.6/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPEC26AutoEventRule8A6BD817": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP EC2.6 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/EC2.6"
              ],
              "ProductFields": {
                "ControlId": [
                  "EC2.6"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_EC2.6_AutoTrigger",
        "State": {
          "Ref": "AFSBPEC26AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPEC26EventsRuleRole1B433881",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.6/AutoEventRule/Resource"
      }
    },
    "AFSBPEC27EventsRuleRole60F20186": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.7/EventsRuleRole/Resource"
      }
    },
    "AFSBPEC27EventsRuleRoleDefaultPolicy93044CCF": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPEC27EventsRuleRoleDefaultPolicy93044CCF",
        "Roles": [
          {
            "Ref": "AFSBPEC27EventsRuleRole60F20186"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.7/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPEC27AutoEventRule0E7F144F": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP EC2.7 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/EC2.7"
              ],
              "ProductFields": {
                "ControlId": [
                  "EC2.7"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_EC2.7_AutoTrigger",
        "State": {
          "Ref": "AFSBPEC27AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPEC27EventsRuleRole60F20186",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP EC2.7/AutoEventRule/Resource"
      }
    },
    "AFSBPIAM7EventsRuleRoleB27A2436": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP IAM.7/EventsRuleRole/Resource"
      }
    },
    "AFSBPIAM7EventsRuleRoleDefaultPolicyBA6C7A51": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPIAM7EventsRuleRoleDefaultPolicyBA6C7A51",
        "Roles": [
          {
            "Ref": "AFSBPIAM7EventsRuleRoleB27A2436"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP IAM.7/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPIAM7AutoEventRule461297C4": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP IAM.7 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/IAM.7"
              ],
              "ProductFields": {
                "ControlId": [
                  "IAM.7"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_IAM.7_AutoTrigger",
        "State": {
          "Ref": "AFSBPIAM7AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPIAM7EventsRuleRoleB27A2436",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP IAM.7/AutoEventRule/Resource"
      }
    },
    "AFSBPIAM8EventsRuleRoleA1AE4233": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP IAM.8/EventsRuleRole/Resource"
      }
    },
    "AFSBPIAM8EventsRuleRoleDefaultPolicy52D789CD": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPIAM8EventsRuleRoleDefaultPolicy52D789CD",
        "Roles": [
          {
            "Ref": "AFSBPIAM8EventsRuleRoleA1AE4233"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP IAM.8/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPIAM8AutoEventRule9290B681": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP IAM.8 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/IAM.8"
              ],
              "ProductFields": {
                "ControlId": [
                  "IAM.8"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_IAM.8_AutoTrigger",
        "State": {
          "Ref": "AFSBPIAM8AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPIAM8EventsRuleRoleA1AE4233",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP IAM.8/AutoEventRule/Resource"
      }
    },
    "AFSBPLambda1EventsRuleRoleF9D0E68B": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP Lambda.1/EventsRuleRole/Resource"
      }
    },
    "AFSBPLambda1EventsRuleRoleDefaultPolicy65DBADE9": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPLambda1EventsRuleRoleDefaultPolicy65DBADE9",
        "Roles": [
          {
            "Ref": "AFSBPLambda1EventsRuleRoleF9D0E68B"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP Lambda.1/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPLambda1AutoEventRuleB663D23F": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP Lambda.1 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/Lambda.1"
              ],
              "ProductFields": {
                "ControlId": [
                  "Lambda.1"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_Lambda.1_AutoTrigger",
        "State": {
          "Ref": "AFSBPLambda1AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPLambda1EventsRuleRoleF9D0E68B",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP Lambda.1/AutoEventRule/Resource"
      }
    },
    "AFSBPRDS1EventsRuleRoleA28379F4": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP RDS.1/EventsRuleRole/Resource"
      }
    },
    "AFSBPRDS1EventsRuleRoleDefaultPolicy3F204712": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPRDS1EventsRuleRoleDefaultPolicy3F204712",
        "Roles": [
          {
            "Ref": "AFSBPRDS1EventsRuleRoleA28379F4"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP RDS.1/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPRDS1AutoEventRuleF3474A4C": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP RDS.1 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/RDS.1"
              ],
              "ProductFields": {
                "ControlId": [
                  "RDS.1"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_RDS.1_AutoTrigger",
        "State": {
          "Ref": "AFSBPRDS1AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPRDS1EventsRuleRoleA28379F4",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP RDS.1/AutoEventRule/Resource"
      }
    },
    "AFSBPRDS6EventsRuleRoleC40F92FF": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP RDS.6/EventsRuleRole/Resource"
      }
    },
    "AFSBPRDS6EventsRuleRoleDefaultPolicyC9A77BA4": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPRDS6EventsRuleRoleDefaultPolicyC9A77BA4",
        "Roles": [
          {
            "Ref": "AFSBPRDS6EventsRuleRoleC40F92FF"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP RDS.6/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPRDS6AutoEventRule68B8F587": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP RDS.6 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/RDS.6"
              ],
              "ProductFields": {
                "ControlId": [
                  "RDS.6"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_RDS.6_AutoTrigger",
        "State": {
          "Ref": "AFSBPRDS6AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPRDS6EventsRuleRoleC40F92FF",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP RDS.6/AutoEventRule/Resource"
      }
    },
    "AFSBPRDS7EventsRuleRole4E57829C": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP RDS.7/EventsRuleRole/Resource"
      }
    },
    "AFSBPRDS7EventsRuleRoleDefaultPolicyEA7C7B62": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPRDS7EventsRuleRoleDefaultPolicyEA7C7B62",
        "Roles": [
          {
            "Ref": "AFSBPRDS7EventsRuleRole4E57829C"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP RDS.7/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPRDS7AutoEventRule848E787E": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP RDS.7 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/RDS.7"
              ],
              "ProductFields": {
                "ControlId": [
                  "RDS.7"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_RDS.7_AutoTrigger",
        "State": {
          "Ref": "AFSBPRDS7AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPRDS7EventsRuleRole4E57829C",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP RDS.7/AutoEventRule/Resource"
      }
    },
    "AFSBPS31EventsRuleRole7E5BE635": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.1/EventsRuleRole/Resource"
      }
    },
    "AFSBPS31EventsRuleRoleDefaultPolicyF4925CF9": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPS31EventsRuleRoleDefaultPolicyF4925CF9",
        "Roles": [
          {
            "Ref": "AFSBPS31EventsRuleRole7E5BE635"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.1/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPS31AutoEventRule98E1B83D": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP S3.1 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/S3.1"
              ],
              "ProductFields": {
                "ControlId": [
                  "S3.1"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_S3.1_AutoTrigger",
        "State": {
          "Ref": "AFSBPS31AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPS31EventsRuleRole7E5BE635",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.1/AutoEventRule/Resource"
      }
    },
    "AFSBPS32EventsRuleRole087A54B3": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.2/EventsRuleRole/Resource"
      }
    },
    "AFSBPS32EventsRuleRoleDefaultPolicy35402CF3": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPS32EventsRuleRoleDefaultPolicy35402CF3",
        "Roles": [
          {
            "Ref": "AFSBPS32EventsRuleRole087A54B3"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.2/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPS32AutoEventRule1F14B41A": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP S3.2 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/S3.2"
              ],
              "ProductFields": {
                "ControlId": [
                  "S3.2"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_S3.2_AutoTrigger",
        "State": {
          "Ref": "AFSBPS32AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPS32EventsRuleRole087A54B3",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.2/AutoEventRule/Resource"
      }
    },
    "RemapAFSBPS33665DB5F0": {
      "Type": "AWS::SSM::Parameter",
      "Properties": {
        "Type": "String",
        "Value": "S3.2",
        "Description": "Remap the AFSBP S3.3 finding to AFSBP S3.2 remediation",
        "Name": "/Solutions/SO0111/AFSBP/1.0.0/S3.3/remap"
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/Remap AFSBP S3.3/Resource"
      }
    },
    "AFSBPS33EventsRuleRoleA177EAAA": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.3/EventsRuleRole/Resource"
      }
    },
    "AFSBPS33EventsRuleRoleDefaultPolicy97673B3D": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPS33EventsRuleRoleDefaultPolicy97673B3D",
        "Roles": [
          {
            "Ref": "AFSBPS33EventsRuleRoleA177EAAA"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.3/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPS33AutoEventRule056D09B9": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP S3.3 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/S3.3"
              ],
              "ProductFields": {
                "ControlId": [
                  "S3.3"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_S3.3_AutoTrigger",
        "State": {
          "Ref": "AFSBPS33AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPS33EventsRuleRoleA177EAAA",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.3/AutoEventRule/Resource"
      }
    },
    "AFSBPS35EventsRuleRole1330F6DC": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.5/EventsRuleRole/Resource"
      }
    },
    "AFSBPS35EventsRuleRoleDefaultPolicy83E3156B": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AFSBPS35EventsRuleRoleDefaultPolicy83E3156B",
        "Roles": [
          {
            "Ref": "AFSBPS35EventsRuleRole1330F6DC"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.5/EventsRuleRole/DefaultPolicy/Resource"
      }
    },
    "AFSBPS35AutoEventRuleA902DF8E": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "Description": "Remediate AFSBP S3.5 automatic remediation trigger event rule.",
        "EventPattern": {
          "source": [
            "aws.securityhub"
          ],
          "detail-type": [
            "Security Hub Findings - Imported"
          ],
          "detail": {
            "findings": {
              "GeneratorId": [
                "aws-foundational-security-best-practices/v/1.0.0/S3.5"
              ],
              "ProductFields": {
                "ControlId": [
                  "S3.5"
                ]
              },
              "Workflow": {
                "Status": [
                  "NEW"
                ]
              },
              "Compliance": {
                "Status": [
                  "FAILED",
                  "WARNING"
                ]
              }
            }
          }
        },
        "Name": "AFSBP_S3.5_AutoTrigger",
        "State": {
          "Ref": "AFSBPS35AutoTrigger"
        },
        "Targets": [
          {
            "Arn": {
              "Ref": "SsmParameterValueSolutionsSO0111OrchestratorArnC96584B6F00A464EAD1953AFF4B05118Parameter"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "AFSBPS35EventsRuleRole1330F6DC",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "AFSBPStack/AFSBP S3.5/AutoEventRule/Resource"
      }
    }
  },
  "Mappings": {
    "SourceCode": {
      "General": {
        "S3Bucket": "solutions",
        "KeyPrefix": "aws-security-hub-automated-response-and-remediation/v1.4.0"
      }
    }
  }
}